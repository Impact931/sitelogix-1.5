# SiteLogix 1.5 - DynamoDB Schema Visual Guide
## Entity Relationships & Data Flow

**Last Updated:** November 4, 2025

---

## Table Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SITELOGIX DATA ARCHITECTURE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ElevenLabs Voice Recording     â”‚
                    â”‚   (Foreman Daily Report)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚         S3: Audio + Transcript Storage         â”‚
            â”‚  SiteLogix/projects/{id}/audio/{date}/...     â”‚
            â”‚  SiteLogix/projects/{id}/transcripts/...      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         ğŸ“Š REPORTS TABLE (Primary Entity)               â”‚
        â”‚  PK: REPORT#{reportId}  SK: METADATA                   â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚ â€¢ reportId, conversationId                       â”‚  â”‚
        â”‚  â”‚ â€¢ projectId, managerId, reportDate               â”‚  â”‚
        â”‚  â”‚ â€¢ rawTranscriptText (for AI processing)          â”‚  â”‚
        â”‚  â”‚ â€¢ status, timestamps, GPS, device metadata       â”‚  â”‚
        â”‚  â”‚ â€¢ S3 paths (audio, transcript)                   â”‚  â”‚
        â”‚  â”‚ â€¢ Checksums (SHA-256 for integrity)              â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚                                                          â”‚
        â”‚  GSI1: project_id + report_date (Timeline)              â”‚
        â”‚  GSI2: manager_id + report_date (Performance)           â”‚
        â”‚  GSI3: status + timestamp (Workflow Queue)              â”‚
        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚              â”‚              â”‚              â”‚
            â”‚              â”‚              â”‚              â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚              â”‚
   â”‚  AI PROCESSING  â”‚    â”‚              â”‚              â”‚
   â”‚     LAMBDA      â”‚    â”‚              â”‚              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚              â”‚
            â”‚              â”‚              â”‚              â”‚
            â†“              â†“              â†“              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§  AI CACHE TABLE â”‚ â”‚ ğŸ‘· PERSONâ”‚ â”‚ ğŸ¢ VENDOR â”‚ â”‚ âš ï¸ CONSTRAINTâ”‚
â”‚  (NEW TABLE)      â”‚ â”‚   TABLE  â”‚ â”‚   TABLE   â”‚ â”‚    TABLE     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚             â”‚              â”‚
                           â”‚             â”‚              â”‚
                           â”‚             â”‚              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      ğŸ“‹ WORK LOGS TABLE (NEW TABLE)        â”‚
                    â”‚  Detailed activity tracking by team/level  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Table Details & Access Patterns

### 1ï¸âƒ£ REPORTS TABLE (Central Hub)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         sitelogix-reports                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Primary Key Structure:                                             â”‚
â”‚    PK: "REPORT#rpt_20251104_mgr_001_1730750400"                    â”‚
â”‚    SK: "METADATA"                                                   â”‚
â”‚                                                                     â”‚
â”‚  Global Secondary Indexes:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI1-ProjectIndex                                            â”‚  â”‚
â”‚  â”‚   PK: project_id = "proj_001"                                â”‚  â”‚
â”‚  â”‚   SK: report_date = "2025-11-04"                             â”‚  â”‚
â”‚  â”‚   USE: Query all reports for a project in date range        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI2-ManagerIndex                                            â”‚  â”‚
â”‚  â”‚   PK: manager_id = "mgr_001"                                 â”‚  â”‚
â”‚  â”‚   SK: report_date = "2025-11-04"                             â”‚  â”‚
â”‚  â”‚   USE: Track manager performance over time                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI3-StatusIndex (NEW)                                       â”‚  â”‚
â”‚  â”‚   PK: status = "pending_review"                              â”‚  â”‚
â”‚  â”‚   SK: timestamp = "2025-11-04T14:30:00Z"                     â”‚  â”‚
â”‚  â”‚   USE: Workflow queue (reports needing review/approval)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  Key Attributes:                                                    â”‚
â”‚    â€¢ reportId, conversationId                                       â”‚
â”‚    â€¢ projectId, projectName, projectLocation                        â”‚
â”‚    â€¢ managerId, managerName                                         â”‚
â”‚    â€¢ reportDate, timestamp, timezone                                â”‚
â”‚    â€¢ status (workflow state)                                        â”‚
â”‚    â€¢ transcriptS3Path, audioS3Path, checksums                       â”‚
â”‚    â€¢ rawTranscriptText (AI input)                                   â”‚
â”‚    â€¢ GPS coordinates, device metadata                               â”‚
â”‚    â€¢ AI processing metadata (model, confidence, version)            â”‚
â”‚                                                                     â”‚
â”‚  Stream: âœ… Enabled (NEW_AND_OLD_IMAGES)                            â”‚
â”‚  PITR:   âœ… Enabled (35-day recovery)                               â”‚
â”‚  Items:  ~100+ (growing daily)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2ï¸âƒ£ PERSONNEL TABLE (Master Registry)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       sitelogix-personnel                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Primary Key Structure (Multi-Record Pattern):                      â”‚
â”‚    PK: "PERSON#550e8400-e29b-41d4-a716-446655440000"               â”‚
â”‚    SK: "PROFILE"           (Current state)                          â”‚
â”‚    SK: "HISTORY#rpt_...#timestamp"  (Work history records)          â”‚
â”‚                                                                     â”‚
â”‚  Global Secondary Indexes:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI1-NameIndex                                               â”‚  â”‚
â”‚  â”‚   PK: full_name = "Aaron Rodriguez"                          â”‚  â”‚
â”‚  â”‚   USE: Fuzzy name matching for deduplication                 â”‚  â”‚
â”‚  â”‚   QUERY: Check if person exists before creating new          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI2-StatusIndex (NEEDS REPLACEMENT)                         â”‚  â”‚
â”‚  â”‚   PK: status = "active"                                      â”‚  â”‚
â”‚  â”‚   SK: dateLastSeen = "2025-11-04"                            â”‚  â”‚
â”‚  â”‚   USE: Find inactive workers (status=active, old lastSeen)   â”‚  â”‚
â”‚  â”‚   REPLACES: GSI2-ProjectIndex (project_id only)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  PROFILE Record Attributes:                                         â”‚
â”‚    â€¢ personId, fullName, nicknames, goByName                        â”‚
â”‚    â€¢ currentPosition, employmentStatus, status                      â”‚
â”‚    â€¢ primaryPhone, primaryEmail (PII - encrypt)                     â”‚
â”‚    â€¢ totalReportsCount, totalHoursWorked, totalOvertimeHours        â”‚
â”‚    â€¢ dateFirstSeen, dateLastSeen                                    â”‚
â”‚    â€¢ skills, certifications                                         â”‚
â”‚    â€¢ fuzzyMatchScore, mergedFrom (deduplication)                    â”‚
â”‚                                                                     â”‚
â”‚  HISTORY Record Attributes:                                         â”‚
â”‚    â€¢ reportId, reportDate, projectId, projectName                   â”‚
â”‚    â€¢ position, teamAssignment                                       â”‚
â”‚    â€¢ hoursWorked, overtimeHours                                     â”‚
â”‚    â€¢ healthStatus, safetyIncident                                   â”‚
â”‚    â€¢ activitiesPerformed, extractedFromText                         â”‚
â”‚                                                                     â”‚
â”‚  Query Pattern - Get Work History:                                  â”‚
â”‚    Query(PK="PERSON#{id}", SK begins_with "HISTORY#")              â”‚
â”‚                                                                     â”‚
â”‚  Stream: âœ… Enabled   PITR: âœ… Enabled   Items: 128                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3ï¸âƒ£ VENDORS TABLE (Supplier/Subcontractor Registry)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        sitelogix-vendors                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Primary Key Structure (Multi-Record Pattern):                      â”‚
â”‚    PK: "VENDOR#650e8400-e29b-41d4-a716-446655440000"               â”‚
â”‚    SK: "PROFILE"           (Current state)                          â”‚
â”‚    SK: "DELIVERY#rpt_...#timestamp"  (Delivery history)             â”‚
â”‚                                                                     â”‚
â”‚  Global Secondary Indexes:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI1-CompanyIndex                                            â”‚  â”‚
â”‚  â”‚   PK: company_name = "ABC Supply Company"                    â”‚  â”‚
â”‚  â”‚   USE: Fuzzy company name matching for deduplication         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI2-TypeIndex (NEW - NEEDS CREATION)                        â”‚  â”‚
â”‚  â”‚   PK: vendor_type = "subcontractor"                          â”‚  â”‚
â”‚  â”‚   SK: dateLastSeen = "2025-11-04"                            â”‚  â”‚
â”‚  â”‚   USE: Filter by type, find inactive vendors                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  PROFILE Record Attributes:                                         â”‚
â”‚    â€¢ vendorId, companyName, companyNameVariations                   â”‚
â”‚    â€¢ vendorType, subcontractorTrade                                 â”‚
â”‚    â€¢ contactName, contactPhone, contactEmail                        â”‚
â”‚    â€¢ approvalStatus, approvedBy, approvedAt                         â”‚
â”‚    â€¢ totalDeliveriesCount, onTimeDeliveryRate, issuesCount          â”‚
â”‚    â€¢ dateFirstSeen, dateLastSeen                                    â”‚
â”‚    â€¢ averageDeliveryRating, hasInsurance                            â”‚
â”‚                                                                     â”‚
â”‚  DELIVERY Record Attributes:                                        â”‚
â”‚    â€¢ reportId, reportDate, projectId, projectName                   â”‚
â”‚    â€¢ materialsDelivered, deliveryTime, isLateDelivery               â”‚
â”‚    â€¢ receivedBy, deliveryDriverName                                 â”‚
â”‚    â€¢ hasIssues, issueDescription, issueCategory                     â”‚
â”‚    â€¢ deliveryRating, extractedFromText                              â”‚
â”‚                                                                     â”‚
â”‚  Query Pattern - Get Delivery History:                              â”‚
â”‚    Query(PK="VENDOR#{id}", SK begins_with "DELIVERY#")             â”‚
â”‚                                                                     â”‚
â”‚  Stream: âœ… Enabled   PITR: âœ… Enabled   Items: ~50+                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4ï¸âƒ£ CONSTRAINTS TABLE (Issues & Delays)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      sitelogix-constraints                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Primary Key Structure:                                             â”‚
â”‚    PK: "PROJECT#proj_001"                                           â”‚
â”‚    SK: "CONSTRAINT#750e8400-e29b-41d4-a716-446655440000"           â”‚
â”‚                                                                     â”‚
â”‚  Global Secondary Indexes:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI1-CategoryIndex                                           â”‚  â”‚
â”‚  â”‚   PK: category = "Material"                                  â”‚  â”‚
â”‚  â”‚   SK: dateIdentified = "2025-11-04"                          â”‚  â”‚
â”‚  â”‚   USE: Analyze constraints by type across all projects       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI2-StatusIndex                                             â”‚  â”‚
â”‚  â”‚   PK: status = "open"                                        â”‚  â”‚
â”‚  â”‚   SK: severity = "Critical"                                  â”‚  â”‚
â”‚  â”‚   USE: Priority queue (open critical issues first)           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI3-ProjectDateIndex (NEW - NEEDS CREATION)                 â”‚  â”‚
â”‚  â”‚   PK: project_id = "proj_001"                                â”‚  â”‚
â”‚  â”‚   SK: report_date = "2025-11-04"                             â”‚  â”‚
â”‚  â”‚   USE: Timeline view of constraints for specific project     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  Key Attributes:                                                    â”‚
â”‚    â€¢ constraintId, projectId, reportId, reportDate                  â”‚
â”‚    â€¢ category, subcategory, severity, status                        â”‚
â”‚    â€¢ title, description, extractedFromText                          â”‚
â”‚    â€¢ buildingLevel, specificArea                                    â”‚
â”‚    â€¢ dateIdentified, dateAcknowledged, dateResolved, daysOpen       â”‚
â”‚    â€¢ assignedTo, resolvedBy, resolutionNotes                        â”‚
â”‚    â€¢ relatedVendorId, relatedPersonnelIds, relatedEquipmentIds      â”‚
â”‚    â€¢ estimatedCostImpact, estimatedScheduleImpact                   â”‚
â”‚    â€¢ safetyIncident, aiConfidence, needsHumanReview                 â”‚
â”‚                                                                     â”‚
â”‚  Categories: Material | Labor | Safety | Coordination |             â”‚
â”‚              Weather | Equipment | Other                            â”‚
â”‚                                                                     â”‚
â”‚  Severity: Low | Medium | High | Critical                           â”‚
â”‚  Status: open | acknowledged | in_progress | resolved | recurring   â”‚
â”‚                                                                     â”‚
â”‚  Stream: âœ… Enabled   PITR: âœ… Enabled   Items: ~200+               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5ï¸âƒ£ WORK LOGS TABLE (NEW - Detailed Activity)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      sitelogix-work-logs                            â”‚
â”‚                     âŒ NOT YET DEPLOYED                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Primary Key Structure:                                             â”‚
â”‚    PK: "REPORT#rpt_20251104_mgr_001_1730750400"                    â”‚
â”‚    SK: "WORKLOG#team_1#level_2"                                    â”‚
â”‚         â””â”€teamIdâ”€â”˜ â””â”€levelâ”€â”˜                                       â”‚
â”‚                                                                     â”‚
â”‚  Global Secondary Indexes:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI1-ProjectDateIndex                                        â”‚  â”‚
â”‚  â”‚   PK: project_id = "proj_001"                                â”‚  â”‚
â”‚  â”‚   SK: report_date = "2025-11-04"                             â”‚  â”‚
â”‚  â”‚   USE: Track project progress over time                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI2-TeamIndex                                               â”‚  â”‚
â”‚  â”‚   PK: team_id = "team_1"                                     â”‚  â”‚
â”‚  â”‚   SK: report_date = "2025-11-04"                             â”‚  â”‚
â”‚  â”‚   USE: Team performance metrics and utilization              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  Key Attributes:                                                    â”‚
â”‚    â€¢ reportId, reportDate, projectId, projectName                   â”‚
â”‚    â€¢ teamId, teamName, buildingLevel, specificArea                  â”‚
â”‚    â€¢ personnelAssigned[], personnelNames[], personnelCount          â”‚
â”‚    â€¢ leadPerson, leadPersonName                                     â”‚
â”‚    â€¢ taskCategory, taskDescription                                  â”‚
â”‚    â€¢ quantityCompleted, quantityUnit (e.g., "240 linear feet")      â”‚
â”‚    â€¢ hoursWorked, regularHours, overtimeHours                       â”‚
â”‚    â€¢ startTime, endTime                                             â”‚
â”‚    â€¢ materialsUsed[], equipmentUsed[]                               â”‚
â”‚    â€¢ progressPercentage, milestoneCompleted                         â”‚
â”‚    â€¢ delaysEncountered, delayReasons[], constraintIds[]             â”‚
â”‚    â€¢ extractedFromText, aiConfidence, needsReview                   â”‚
â”‚                                                                     â”‚
â”‚  Use Cases:                                                         â”‚
â”‚    â€¢ Granular productivity tracking                                 â”‚
â”‚    â€¢ Resource allocation analysis                                   â”‚
â”‚    â€¢ Progress measurement (quantity completed vs estimated)         â”‚
â”‚    â€¢ Link personnel to specific tasks/locations                     â”‚
â”‚    â€¢ Material consumption tracking                                  â”‚
â”‚                                                                     â”‚
â”‚  Table Definition: /infrastructure/table-work-logs.json             â”‚
â”‚  Priority: HIGH (critical for detailed tracking)                    â”‚
â”‚                                                                     â”‚
â”‚  Stream: âœ… Configured   PITR: âœ… Configured                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6ï¸âƒ£ AI ANALYSIS CACHE TABLE (NEW - Performance)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   sitelogix-ai-analysis-cache                       â”‚
â”‚                     âŒ NOT YET DEPLOYED                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Primary Key Structure:                                             â”‚
â”‚    PK: "REPORT#rpt_20251104_mgr_001_1730750400"                    â”‚
â”‚    SK: "AI#personnel_extraction#v1.2.3"                            â”‚
â”‚         â””â”€â”€analysisTypeâ”€â”€â”˜ â””â”€versionâ”€â”˜                             â”‚
â”‚                                                                     â”‚
â”‚  Alternative PK (for deduplication):                                â”‚
â”‚    PK: "CACHE#sha256(transcript_text)"                             â”‚
â”‚    SK: "AI#summary#v1.2.3"                                         â”‚
â”‚                                                                     â”‚
â”‚  Global Secondary Indexes:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI1-TypeIndex                                               â”‚  â”‚
â”‚  â”‚   PK: analysisType = "personnel_extraction"                  â”‚  â”‚
â”‚  â”‚   SK: createdAt = "2025-11-04T14:30:00Z"                     â”‚  â”‚
â”‚  â”‚   USE: Track performance by analysis type                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GSI2-ModelIndex                                              â”‚  â”‚
â”‚  â”‚   PK: modelUsed = "claude-3-opus-20240229"                   â”‚  â”‚
â”‚  â”‚   SK: createdAt = "2025-11-04T14:30:00Z"                     â”‚  â”‚
â”‚  â”‚   USE: Compare model performance and cost                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  Key Attributes:                                                    â”‚
â”‚    â€¢ reportId, cacheKey (SHA-256 hash)                              â”‚
â”‚    â€¢ analysisType (summary | personnel_extraction | etc.)           â”‚
â”‚    â€¢ modelUsed, modelVersion, modelProvider                         â”‚
â”‚    â€¢ promptTemplate, promptContent, promptTokens                    â”‚
â”‚    â€¢ rawResponse, structuredData (parsed JSON)                      â”‚
â”‚    â€¢ completionTokens, totalTokens, estimatedCost                   â”‚
â”‚    â€¢ confidence, validationPassed, needsHumanReview                 â”‚
â”‚    â€¢ processingTime (ms), retryCount, errorMessage                  â”‚
â”‚    â€¢ createdAt, needsReanalysis, reanalysisReason                   â”‚
â”‚    â€¢ ttl (Unix timestamp for auto-expiry)                           â”‚
â”‚    â€¢ supersededBy, version                                          â”‚
â”‚                                                                     â”‚
â”‚  Analysis Types:                                                    â”‚
â”‚    â€¢ summary: Executive summary of report                           â”‚
â”‚    â€¢ personnel_extraction: Extract people, hours, positions         â”‚
â”‚    â€¢ vendor_extraction: Extract vendors, deliveries, issues         â”‚
â”‚    â€¢ constraints: Identify problems, delays, safety concerns        â”‚
â”‚    â€¢ work_logs: Extract detailed work breakdown                     â”‚
â”‚    â€¢ sentiment: Analyze manager sentiment/morale                    â”‚
â”‚                                                                     â”‚
â”‚  Special Features:                                                  â”‚
â”‚    â€¢ TTL: 90-day auto-expiry (configurable)                         â”‚
â”‚    â€¢ Higher throughput: 10 RCU/WCU (vs 5 for others)                â”‚
â”‚    â€¢ Cost tracking: estimatedCost per analysis                      â”‚
â”‚    â€¢ A/B testing: Compare different models/prompts                  â”‚
â”‚                                                                     â”‚
â”‚  Table Definition: /infrastructure/table-ai-analysis-cache.json     â”‚
â”‚  Priority: MEDIUM (performance optimization)                        â”‚
â”‚                                                                     â”‚
â”‚  Stream: âœ… Configured   PITR: âœ… Configured                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagrams

### Flow 1: Report Submission & Processing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Foreman    â”‚
â”‚ (Mobile App) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. Voice recording via ElevenLabs
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ElevenLabs Service â”‚
â”‚  Conversation API  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. Returns conversationId + transcript
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  S3: Audio Storage â”‚  (immutable)
â”‚  S3: Transcript    â”‚  (immutable)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. Upload complete
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   REPORTS TABLE (DynamoDB)     â”‚
â”‚   â€¢ Store metadata             â”‚
â”‚   â€¢ Store rawTranscriptText    â”‚
â”‚   â€¢ Status: pending_analysis   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 4. DynamoDB Stream event
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI Processing Lambda  â”‚
â”‚  â€¢ Read transcript     â”‚
â”‚  â€¢ Call Claude/GPT-4   â”‚
â”‚  â€¢ Extract entities    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 5. AI responses
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“                  â†“                  â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PERSONNEL  â”‚  â”‚    VENDORS    â”‚  â”‚  CONSTRAINTS  â”‚  â”‚ WORK LOGS  â”‚
â”‚   TABLE    â”‚  â”‚     TABLE     â”‚  â”‚     TABLE     â”‚  â”‚   TABLE    â”‚
â”‚            â”‚  â”‚               â”‚  â”‚               â”‚  â”‚            â”‚
â”‚ â€¢ Update orâ”‚  â”‚ â€¢ Update or   â”‚  â”‚ â€¢ Create new  â”‚  â”‚ â€¢ Create   â”‚
â”‚   create   â”‚  â”‚   create      â”‚  â”‚   constraint  â”‚  â”‚   work log â”‚
â”‚   records  â”‚  â”‚   records     â”‚  â”‚   records     â”‚  â”‚   records  â”‚
â”‚            â”‚  â”‚               â”‚  â”‚               â”‚  â”‚            â”‚
â”‚ â€¢ Add      â”‚  â”‚ â€¢ Add         â”‚  â”‚ â€¢ Link to     â”‚  â”‚ â€¢ Link to  â”‚
â”‚   HISTORY  â”‚  â”‚   DELIVERY    â”‚  â”‚   report      â”‚  â”‚   report   â”‚
â”‚   records  â”‚  â”‚   records     â”‚  â”‚               â”‚  â”‚   & team   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  AI CACHE TABLE    â”‚
                 â”‚  â€¢ Store responses â”‚
                 â”‚  â€¢ Track costs     â”‚
                 â”‚  â€¢ Performance     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  REPORTS TABLE     â”‚
                 â”‚  Update status:    â”‚
                 â”‚  analyzed          â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Notification       â”‚
                 â”‚ â€¢ PM dashboard     â”‚
                 â”‚ â€¢ Email digest     â”‚
                 â”‚ â€¢ Google Sheets    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flow 2: Deduplication Process (Personnel/Vendors)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI extracts name: "A Rodriguez"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Fuzzy Matching Service (Lambda)       â”‚
â”‚  1. Normalize: "a rodriguez"           â”‚
â”‚  2. Query GSI1-NameIndex               â”‚
â”‚  3. Calculate Levenshtein distance     â”‚
â”‚  4. Phonetic match (Soundex)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Score >= 95? â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         Yes â†“     â†“ No
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AUTO-MATCH    â”‚    â”‚ Score 80-94?    â”‚
â”‚ Return        â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ existing ID   â”‚      Yesâ”‚   â”‚No
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â†“   â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ CREATE PENDING       â”‚
                  â”‚ REVIEW RECORD        â”‚
                  â”‚ â€¢ Flag for admin     â”‚
                  â”‚ â€¢ Show match score   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚No
                          â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ CREATE NEW ENTITY    â”‚
                  â”‚ â€¢ Generate UUID      â”‚
                  â”‚ â€¢ Status: active     â”‚
                  â”‚ â€¢ Store variations   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flow 3: Data Lifecycle & Archival

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HOT TIER (0-90 days)                         â”‚
â”‚                         DynamoDB Tables                             â”‚
â”‚                                                                     â”‚
â”‚  â€¢ Fast queries (< 100ms)                                           â”‚
â”‚  â€¢ PITR enabled (35-day recovery)                                   â”‚
â”‚  â€¢ DynamoDB Streams â†’ Lambda processors                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ Age > 90 days
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ARCHIVAL LAMBDA (Stream Consumer)                â”‚
â”‚                                                                     â”‚
â”‚  1. Detect aged records (createdAt > 90 days)                       â”‚
â”‚  2. Convert to Parquet format                                       â”‚
â”‚  3. Write to S3 with partition keys                                 â”‚
â”‚  4. Verify write success                                            â”‚
â”‚  5. Delete from DynamoDB (after confirmation)                       â”‚
â”‚  6. Write to audit log                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       WARM TIER (90 days - 1 year)                  â”‚
â”‚                    S3 Standard Storage + Athena                     â”‚
â”‚                                                                     â”‚
â”‚  Path: s3://sitelogix-archive/reports/{YYYY}/{MM}/{DD}/...         â”‚
â”‚                                                                     â”‚
â”‚  â€¢ Parquet format (columnar, compressed)                            â”‚
â”‚  â€¢ Athena-queryable (SQL interface)                                 â”‚
â”‚  â€¢ Query time: < 5 seconds for date range                           â”‚
â”‚  â€¢ Cost: $0.023/GB storage + $5/TB scanned                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ Age > 1 year
                             â”‚ S3 Lifecycle Policy
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      COLD TIER (1-7 years)                          â”‚
â”‚                  S3 Glacier Flexible Retrieval                      â”‚
â”‚                                                                     â”‚
â”‚  â€¢ OSHA compliance (7-year retention)                               â”‚
â”‚  â€¢ Legal hold capability                                            â”‚
â”‚  â€¢ Still queryable via Athena (with restore delay)                  â”‚
â”‚  â€¢ Retrieval time: 3-5 hours (standard) or 12 hours (bulk)          â”‚
â”‚  â€¢ Cost: $0.004/GB/month (90% cheaper than Standard)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## GSI Strategy Summary

### Reports Table GSIs
| Index | Hash Key | Range Key | Purpose | Usage |
|-------|----------|-----------|---------|-------|
| GSI1-ProjectIndex | project_id | report_date | Project timeline | High |
| GSI2-ManagerIndex | manager_id | report_date | Manager performance | Medium |
| GSI3-StatusIndex | status | timestamp | Workflow queue | High |

### Personnel Table GSIs
| Index | Hash Key | Range Key | Purpose | Usage |
|-------|----------|-----------|---------|-------|
| GSI1-NameIndex | full_name | - | Deduplication | Very High |
| GSI2-StatusIndex | status | dateLastSeen | Inactive detection | Medium |

### Vendors Table GSIs
| Index | Hash Key | Range Key | Purpose | Usage |
|-------|----------|-----------|---------|-------|
| GSI1-CompanyIndex | company_name | - | Deduplication | Very High |
| GSI2-TypeIndex | vendor_type | dateLastSeen | Type filtering | Medium |

### Constraints Table GSIs
| Index | Hash Key | Range Key | Purpose | Usage |
|-------|----------|-----------|---------|-------|
| GSI1-CategoryIndex | category | dateIdentified | Trend analysis | Medium |
| GSI2-StatusIndex | status | severity | Priority queue | High |
| GSI3-ProjectDateIndex | project_id | report_date | Project timeline | High |

### Work Logs Table GSIs
| Index | Hash Key | Range Key | Purpose | Usage |
|-------|----------|-----------|---------|-------|
| GSI1-ProjectDateIndex | project_id | report_date | Progress tracking | Very High |
| GSI2-TeamIndex | team_id | report_date | Team performance | High |

### AI Cache Table GSIs
| Index | Hash Key | Range Key | Purpose | Usage |
|-------|----------|-----------|---------|-------|
| GSI1-TypeIndex | analysisType | createdAt | Performance by type | Medium |
| GSI2-ModelIndex | modelUsed | createdAt | Model comparison | Medium |

---

## Key Takeaways

### âœ… Strengths of This Design
1. **Immutability:** History preserved via multi-record patterns
2. **Deduplication:** GSI-based fuzzy matching prevents duplicates
3. **Audit Trail:** Streams capture every change
4. **Scalability:** Hot/warm/cold tiering keeps costs manageable
5. **AI-Friendly:** Raw text stored for reprocessing
6. **Compliance:** 7-year retention, PITR, checksums

### âš ï¸ Known Limitations
1. **Cross-Table Queries:** No native joins (use application-level)
2. **GSI Latency:** Eventual consistency (~1 second lag)
3. **Cost at Scale:** Monitor GSI usage to prevent runaway costs
4. **Deduplication:** Requires active admin review workflow

### ğŸš€ Next Steps
1. Review and approve design
2. Execute migration plan (1-2 weeks)
3. Deploy stream processors (audit trail, archival)
4. Implement deduplication logic
5. Build admin dashboard for review workflows

---

**Document Status:** Visual Guide Complete
**Last Updated:** November 4, 2025
**Related Docs:**
- `/DYNAMODB_COMPLETE_SCHEMA_DESIGN.md` (full spec)
- `/infrastructure/MIGRATION_PLAN.md` (execution guide)
- `/SCHEMA_SUMMARY.md` (quick reference)
